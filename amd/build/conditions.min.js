/**
 * Handles applying conditions.
 *
 * @module     profilefield_conditional/conditions
 * @copyright  2016 Shamim Rezaie <http://foodle.org>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("profilefield_conditional/conditions",["jquery"],(function($){var getFieldRow=function(field){var fieldRow=$("#fitem_id_profile_field_"+field);return 0===fieldRow.length&&(fieldRow=$(".fitem [name=profile_field_"+field+"], .fitem [name^=profile_field_"+field+"\\[]").closest(".fitem.row")),fieldRow},Conditions=function(fieldName){this.fieldName=fieldName;var conditionalField=$("#id_profile_field_"+fieldName);this.conditions=conditionalField.data("conditions");var allElements=[];this.conditions.forEach((function(option){option.hiddenfields.forEach((function(field){-1==$.inArray(field,allElements)&&allElements.push(field)})),option.requiredfields.forEach((function(field){-1==$.inArray(field,allElements)&&allElements.push(field)}))})),this.allElements=allElements,this.reqHTML=conditionalField.data("reqHtml"),this.initReqStars(),this.toggleReqStars(),conditionalField.change(this.toggleReqStars.bind(this))};return Conditions.prototype.fieldName=null,Conditions.prototype.conditions=null,Conditions.prototype.allElements=null,Conditions.prototype.options=null,Conditions.prototype.initReqStars=function(){var initReqFields=[];this.allElements.forEach((function(element){0===getFieldRow(element).find(".fitemtitle .req").length&&0===getFieldRow(element).find("abbr.text-danger").length||initReqFields.push(element)})),this.conditions.push({option:"",requiredfields:initReqFields})},Conditions.prototype.toggleReqStars=function(){var requiredfields,fieldRow,node,selectedValue=$("#id_profile_field_"+this.fieldName).val(),reqHTML=this.reqHTML,allElements=this.allElements,oldStyle=null;this.conditions.forEach((function(option){option.option==selectedValue&&(requiredfields=option.requiredfields,allElements.forEach((function(element){fieldRow=getFieldRow(element),null===oldStyle&&(oldStyle=fieldRow.has(".float-sm-right").length),-1!=$.inArray(element,requiredfields)?(0===(node=fieldRow.find(".text-danger")).length&&(node=$(reqHTML).hide(),oldStyle?fieldRow.find(".float-sm-right").append(node):fieldRow.find(".col-form-label .align-items-center").append(node)),node.show()):fieldRow.find(".text-danger").hide(0,(function(){-1!=$.inArray(element,requiredfields)&&getFieldRow(element).find(".text-danger").remove()}))})))})),this.reqHTML=reqHTML},{apply:function(fieldName){return new Conditions(fieldName)}}}));

//# sourceMappingURL=conditions.min.js.map